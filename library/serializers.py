# Link on GitHub: https://github.com/viacheslav-bandylo/111124-projects/blob/main/library/serializers.py

from rest_framework import serializers
from django.utils import timezone
from library.models import Book, Publisher, Genre, SimpleBook
from library.validators import validate_title_length



# \\\\\   –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –≤ Django REST Framework?   /////
# üîπ –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä ‚Äî —ç—Ç–æ ¬´–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫¬ª –º–µ–∂–¥—É —Å–ª–æ–∂–Ω—ã–º–∏ –æ–±—ä–µ–∫—Ç–∞–º–∏,
# (–Ω–∞–ø—Ä–∏–º–µ—Ä, Django-–º–æ–¥–µ–ª—è–º–∏) –∏ –ø—Ä–æ—Å—Ç—ã–º–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö (—Å–ª–æ–≤–∞—Ä—è–º–∏, JSON).
# –û–Ω —É–º–µ–µ—Ç:
#   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å –º–æ–¥–µ–ª—å ‚Üí JSON (–¥–ª—è –æ—Ç–¥–∞—á–∏ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É).
#   - –ü—Ä–µ–æ–±—Ä–∞–∑–æ–≤—ã–≤–∞—Ç—å JSON ‚Üí –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ (–¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è).
#   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (–≤–∞–ª–∏–¥–∞—Ü–∏—è).



# # ----------------------------------------------------------------
# # –ó–ê–ö–û–ú–ú–ï–ù–¢–ò–†–û–í–ê–¢–¨ –≤–µ—Å—å —ç—Ç–æ—Ç —Å–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä!!!!!!!!!!!!!!!!!!!!
# # See Les22-Django_22-REST_p1_Serializer-26_06.pdf, page 60.
# # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –º–∞—Å—Å–∏–≤–∞ –∫–Ω–∏–≥:
# class BookListSerializer(serializers.ModelSerializer):
#     class Meta:
#         model = Book
#         # –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–µ –ø–æ–ª—è –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–Ω–∏–≥:
#         fields = ['id', 'title', 'author']
# # ----------------------------------------------------------------




# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

# –°–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ë–î –ò–ó–î–ê–¢–ï–õ–Ø.
class PublisherSerializer(serializers.ModelSerializer):
    """

    """
    class Meta:
        model = Publisher
        fields = '__all__'



# –°–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ë–î –ù–û–í–û–ô  –ö–ù–ò–ì–ò.
# –ü–æ—Å—è—Å–Ω–µ–Ω–∏—è –æ—Ç Chat —Å–º–æ—Ç—Ä–∏ —Ç—É—Ç: https://chatgpt.com/s/t_68b92bdab62081919079199a9896988e.
class BookCreateSerializer(serializers.ModelSerializer):
    """
    Creating a new Book with validations of the title.
    """
    # created_at = serializers.DateTimeField(read_only=True)

    # –Ø–≤–Ω–æ –æ–±—ä—è–≤–ª—è–µ–º –ø–æ–ª–µ title –∏ –≤–µ—à–∞–µ–º –∫–∞—Å—Ç–æ–º–Ω—ã–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä validate_title_length
    # (—Ñ—É–Ω–∫—Ü–∏—è –≤–Ω–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞). –û–Ω —Å—Ä–∞–±–æ—Ç–∞–µ—Ç –¥–æ –º–µ—Ç–æ–¥–æ–≤ validate_* –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞:
    title = serializers.CharField(validators=[validate_title_length])

    # –ß–∏—Å–ª–æ–≤–æ–µ –ø–æ–ª–µ. –ï—Å–ª–∏ –≤ –º–æ–¥–µ–ª–∏ —Ç–∏–ø Integer/PositiveInteger ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ ¬´–ø–æ–≤–µ—Ä—Ö¬ª –º–æ–¥–µ–ª—å–Ω–æ–≥–æ –ø–æ–ª—è,
    # —á—Ç–æ–±—ã –∑–∞–¥–∞—Ç—å/–ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–æ–≤–µ–¥–µ–Ω–∏–µ (messages, required –∏ —Ç.–ø.):
    amount_pages = serializers.IntegerField()

    # SlugRelatedField ‚Äî —ç—Ç–æ —Å–≤—è–∑—å ¬´–ø–æ —Å–ª–∞–≥—É¬ª, –∞ –Ω–µ –ø–æ –ø–µ—Ä–≤–∏—á–Ω–æ–º—É –∫–ª—é—á—É:
    publisher = serializers.SlugRelatedField(
        slug_field='slug',
        queryset=Publisher.objects.all(),       # Writeable slug-based relation.
    )
    #   - –í—Ö–æ–¥ (write): –≤ –∑–∞–ø—Ä–æ—Å–µ –∫–ª–∏–µ–Ω—Ç –ø—Ä–∏—Å—ã–ª–∞–µ—Ç —Å—Ç—Ä–æ–∫—É —Å–æ –∑–Ω–∞—á–µ–Ω–∏–µ–º –ø–æ–ª—è slug –∏–∑–¥–∞—Ç–µ–ª—è
    #     (–Ω–∞–ø—Ä–∏–º–µ—Ä, "penguin-books"). DRF –∏—â–µ—Ç –æ–±—ä–µ–∫—Ç Publisher –ø–æ slug=... –≤ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–º queryset.
    #   - –í—ã—Ö–æ–¥ (read): –≤ –æ—Ç–≤–µ—Ç–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –≤–µ—Ä–Ω—ë—Ç —Å—Ç—Ä–æ–∫—É-—Å–ª–∞–≥ (–∞ –Ω–µ –æ–±—ä–µ–∫—Ç, –∏ –Ω–µ id).
    #   - –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è, —á—Ç–æ–±—ã Publisher.slug –±—ã–ª —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ‚Äî –∏–Ω–∞—á–µ –ø—Ä–∏ –∑–∞–ø–∏—Å–∏ DRF –Ω–µ —Å–º–æ–∂–µ—Ç –æ–¥–Ω–æ–∑–Ω–∞—á–Ω–æ –Ω–∞–π—Ç–∏ –æ–±—ä–µ–∫—Ç.

    # –ö–æ—Ä–æ—Ç–∫–æ –ø—Ä–æ SlugRelatedField:
    #   - –î–µ–ª–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–π –∫–ª—é—á ¬´–ø–æ —Å—Ç—Ä–æ–∫–µ¬ª (slug), –∞ –Ω–µ –ø–æ id.
    #   - –¢—Ä–µ–±—É–µ—Ç queryset= –¥–ª—è –∑–∞–ø–∏—Å–∏.
    #   - –í –æ—Ç–≤–µ—Ç–∞—Ö —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ—Ç —Å–∞–º slug.
    #   - –•–æ—Ä–æ—à, –∫–æ–≥–¥–∞ —Ö–æ—Ç–∏—Ç–µ —á–∏—Ç–∞–µ–º—ã–µ URL-—Å–æ–≤–º–µ—Å—Ç–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –≤ API –∏ —Å—Ç–∞–±–∏–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –Ω–∞ —Å–≤—è–∑–∞–Ω–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã.

    class Meta:
        model = Book
        fields = '__all__'
        read_only_fields = ['created_at', 'id']
        #   - fields='__all__' ‚Äî –±–µ—Ä—ë–º –≤—Å–µ –ø–æ–ª—è –º–æ–¥–µ–ª–∏.
        #   - read_only_fields ‚Äî –∫–ª–∏–µ–Ω—Ç –Ω–µ –º–æ–∂–µ—Ç –ø—Ä–∏—Å—ã–ª–∞—Ç—å —ç—Ç–∏ –ø–æ–ª—è; –Ω–æ –≤—ã –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞–≤–∞—Ç—å –∏—Ö –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–∫–∞–∫ –Ω–∏–∂–µ –≤ create), –∏ –æ–Ω–∏ –±—É–¥—É—Ç –≤—ã–≤–æ–¥–∏—Ç—å—Å—è.

    # --- CREATE ---
    # –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –º–µ—Ç–æ–¥–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–∏–≥–∏: –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ—Ä–≤–µ—Ä–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è created_at,
    # —Ç–∞–∫ –∫–∞–∫ –ø–æ–ª–µ read-only –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –µ–≥–æ –Ω–µ –ø—Ä–∏—Å—ã–ª–∞–µ—Ç.
    def create(self, validated_data):
        # —Å–µ—Ä–≤–µ—Ä —Å–∞–º —Å—Ç–∞–≤–∏—Ç created_at, —Ç.–∫. –≤ Meta –ø–æ–ª–µ –±—ã–ª–æ —Å–∫—Ä—ã—Ç–æ –æ—Ç –∫–ª–∏–µ–Ω—Ç–∞ read_only:
        validated_data['created_at'] = timezone.now()
        # super() –≤—ã–∑—ã–≤–∞–µ—Ç "—Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫—É—é" —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é create() —É ModelSerializer
        return super().create(validated_data)
        # –ó–∞—á–µ–º super()?
        # ModelSerializer.create() –≤–Ω—É—Ç—Ä–∏ DRF –∞–∫–∫—É—Ä–∞—Ç–Ω–æ —Å–æ–∑–¥–∞—ë—Ç –º–æ–¥–µ–ª—å:
        # –¥–µ–ª–∞–µ—Ç instance = Model.objects.create(**validated_data) + –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –º–Ω–æ–≥–∏–µ –∞—Å–ø–µ–∫—Ç—ã
        # (–≤ —Ç.—á. M2M –ø–æ—Å–ª–µ instance.save() –∏ —Ç.–¥.).
        # –ú—ã –ª–∏—à—å ¬´–≤–∫–ª–∏–Ω–∏–≤–∞–µ–º—Å—è¬ª, –¥–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ—ë –ø–æ–ª–µ, –∞ –≤—Å—é —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é –º–µ—Ö–∞–Ω–∏–∫—É –æ—Ç–¥–∞–µ–º ¬´—Ä–æ–¥–∏—Ç–µ–ª—é¬ª.


    # super() ‚Äî —ç—Ç–æ –≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è Python, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–±—Ä–∞—Ç–∏—Ç—å—Å—è –∫
    # –º–µ—Ç–æ–¥—É —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–ª–∞—Å—Å–∞. Chat: https://chatgpt.com/s/t_68b7dfc273ac8191861c755617c7add3
    # –í —Å–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä–∞—Ö DRF super() –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è, –∫–æ–≥–¥–∞ –º—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º –º–µ—Ç–æ–¥—ã
    # —Å–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä–∞, –Ω–∞–ø—Ä–∏–º–µ—Ä:
    #   create()
    #   update()
    #   validate()
    #   to_representation()
    # üîç –ó–¥–µ—Å—å super().create(validated_data):
    #   1) –±–µ—Ä—ë—Ç –≥–æ—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ,
    #   2) –≤—ã–∑—ã–≤–∞–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—É—é —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—é –º–µ—Ç–æ–¥–∞ create —É ModelSerializer,
    #   3) –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë—Ç –æ–±—ä–µ–∫—Ç –≤ –±–∞–∑–µ.
    # –ú—ã –ª–∏—à—å "–≤–∫–ª–∏–Ω–∏–ª–∏—Å—å", –¥–æ–±–∞–≤–∏–≤ created_at.
    # ‚ú® –ò—Ç–æ–≥–æ:
    #   + super() –≤ —Å–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä–∞—Ö DRF –ø–æ–∑–≤–æ–ª—è–µ—Ç –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞—Ç—å –∑–∞–Ω–æ–≤–æ –ª–æ–≥–∏–∫—É, –∫–æ—Ç–æ—Ä–∞—è —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ ModelSerializer (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ, –±–∞–∑–æ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è).
    #   + –¢—ã –¥–æ–±–∞–≤–ª—è–µ—à—å —Å–≤–æ—é –∫–∞—Å—Ç–æ–º–Ω—É—é –ª–æ–≥–∏–∫—É –¥–æ –∏–ª–∏ –ø–æ—Å–ª–µ –≤—ã–∑–æ–≤–∞ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –º–µ—Ç–æ–¥–∞.
    #   + –ë–µ–∑ super() –ø—Ä–∏—à–ª–æ—Å—å –±—ã –≤—Ä—É—á–Ω—É—é –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤–µ—Å—å –∫–æ–¥ –∏–∑ DRF.

    # --- UPDATE ---
    # –ü–µ—Ä–µ–¥ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º ¬´–Ω–æ—Ä–º–∞–ª–∏–∑—É–µ–º¬ª –∑–∞–≥–æ–ª–æ–≤–æ–∫ (–æ–±—Ä–µ–∑–∞–µ–º –ø—Ä–æ–±–µ–ª—ã, –ø—Ä–∏–≤–æ–¥–∏–º –∫ Title Case):
    def update(self, instance, validated_data):
        # –ú—è–≥–∫–∞—è –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –ø–æ–ª–µ –ø—Ä–∏—à–ª–æ:
        if 'title' in validated_data:
            # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ª–æ–≥–∏–∫–∞: –ø—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–∑–≤–∞–Ω–∏–µ –∫–Ω–∏–≥–∏ –∏ —É–¥–∞–ª—è–µ–º –ø—Ä–æ–±–µ–ª—ã (–∏–ª–∏ –¥—Ä—É–≥–∏–µ —É–∫–∞–∑–∞–Ω–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã)
            # –≤ –ù–ê–ß–ê–õ–ï –∏ –≤ –ö–û–ù–¶–ï —Å—Ç—Ä–æ–∫–∏:
            validated_data['title'] = validated_data['title'].strip().title()
        return super().update(instance, validated_data)
        # super().update(...) –≤—ã–ø–æ–ª–Ω–∏—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∞—Ç—Ä–∏–±—É—Ç–æ–≤ –∏ instance.save().

    # ==============================================================================
    # –ö–ª—é—á–µ–≤–∞—è –º—ã—Å–ª—å –ø—Ä–æ super(): —Ä–∞—Å—à–∏—Ä—è–µ–º, –∞ –Ω–µ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–µ–º –±–∞–∑–æ–≤—É—é –ª–æ–≥–∏–∫—É DRF.
    # –≠—Ç–æ –∏–∑–±–∞–≤–ª—è–µ—Ç –æ—Ç –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –∫–æ–¥–∞ –∏ –æ—à–∏–±–æ–∫.
    # ==============================================================================


    # \\\\\   –í–∞–ª–∏–¥–∞—Ç–æ—Ä—ã  /////

    # --- field-level validation ---
    # –ü–æ–ª–µ–≤–æ–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä: DRF –≤—ã–∑–æ–≤–µ—Ç —ç—Ç–æ—Ç –º–µ—Ç–æ–¥ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–æ–ª—è amount_pages –∏ –ø–µ—Ä–µ–¥–∞—Å—Ç –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ value:
    def validate_amount_pages(self, value):
        if value < 1:
            raise serializers.ValidationError("Amount of Pages can't be less then 1.")
        return value

    # --- object-level validation (–∫—Ä–æ—Å—Å-–ø–æ–ª–µ–≤–∞—è) ---
    # ‚ö†Ô∏è –ó–¥–µ—Å—å –µ—Å—Ç—å –æ—à–∏–±–∫–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä—ã.
    # def validate_discount_price(self, data):
    #     if data.get('discount_price') and data.get('price'):
    #         if data['discount_price'] > data['price']:
    #             raise serializers.ValidationError("Discounted price can't be higher then regular price.")
    #     return data
        # –ú–µ—Ç–æ–¥ —Å –∏–º–µ–Ω–µ–º validate_<fieldname> –¥–æ–ª–∂–µ–Ω –≤—ã–≥–ª—è–¥–µ—Ç—å –∫–∞–∫
        #   def validate_discount_price(self, value):
        #   –∏ –≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –æ–¥–Ω–æ –ø–æ–ª–µ.
        # –ù–æ –≤—ã —Å–≤–µ—Ä—è–µ—Ç–µ –¥–≤–∞ –ø–æ–ª—è (discount_price –∏ price) ‚Äî —ç—Ç–æ —Å–∫–≤–æ–∑–Ω–∞—è (object-level) –≤–∞–ª–∏–¥–∞—Ü–∏—è.
        # –î–ª—è –Ω–µ—ë –Ω—É–∂–µ–Ω –º–µ—Ç–æ–¥:
        #   def validate(self, attrs):
        #       # –∑–¥–µ—Å—å –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ –ø–æ–ª—è —Å—Ä–∞–∑—É:
        #       ...
        # –ò–Ω–∞—á–µ DRF –ø–µ—Ä–µ–¥–∞—Å—Ç —Å—é–¥–∞ –æ–¥–Ω–æ –∑–Ω–∞—á–µ–Ω–∏–µ, –∏ data.get(...)  __–†–£–•–ù–ï–¢__.

    # –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ô –∫—Ä–æ—Å—Å-–ø–æ–ª–µ–≤–æ–π –≤–∞–ª–∏–¥–∞—Ç–æ—Ä:
    def validate(self, attrs):
        price = attrs.get('price', getattr(self.instance, 'price', None))
        discount = attrs.get('discount_price', getattr(self.instance, 'discount_price', None))

        if discount is not None and price is not None and discount > price:
            raise serializers.ValidationError(
                {"discount_price": "Discounted price can't be higher than regular price."}
            )
        return attrs
    # –ü–æ—á–µ–º—É —Ç–∞–∫ –ª—É—á—à–µ:
    #   - –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫—Ä–æ—Å—Å-–ø–æ–ª–µ–≤–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è (validate(self, attrs)),
    #      —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –¥–ª—è POST, –∏ –¥–ª—è PATCH (–º—ã –ø–æ–¥—Ö–≤–∞—Ç—ã–≤–∞–µ–º –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ instance, –µ—Å–ª–∏ –ø–æ–ª–µ –Ω–µ –ø—Ä–∏—à–ª–æ –≤ —á–∞—Å—Ç–∏—á–Ω–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏).
    #   - super() –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ä–æ–≤–Ω–æ —Ç–∞–º, –≥–¥–µ –¥–æ–ª–∂–µ–Ω ‚Äî –º—ã –¥–æ–±–∞–≤–ª—è–µ–º —Å–≤–æ—ë –ø–æ–≤–µ–¥–µ–Ω–∏–µ –∏ –¥–æ–≤–µ—Ä—è–µ–º DRF —Ä—É—Ç–∏–Ω—É —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
    #   - SlugRelatedField –æ—Å—Ç–∞—ë—Ç—Å—è –∑–∞–ø–∏—Å—ã–≤–∞–µ–º—ã–º: –Ω–∞ –≤—Ö–æ–¥ ‚Äî —Å–ª–∞–≥, –Ω–∞ –≤—ã—Ö–æ–¥ ‚Äî —Å–ª–∞–≥.

    # =================================================================
    # https://chatgpt.com/s/t_68b92d902f4481919b3bb58b38d2450d
    # \\\\\\\  instance –≤ –º–µ—Ç–æ–¥–∞—Ö —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞  ///////
    # –ö–æ–≥–¥–∞ —Ç—ã –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ—à—å update(self, instance, validated_data), —Ç–æ:
    # instance ‚Äî —ç—Ç–æ –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏, –∫–æ—Ç–æ—Ä—ã–π —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î –∏ –µ–≥–æ –Ω—É–∂–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å.
    # –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ –≤ –±–∞–∑–µ –µ—Å—Ç—å –∫–Ω–∏–≥–∞ —Å id=5, —Ç–æ –ø—Ä–∏ –∑–∞–ø—Ä–æ—Å–µ PUT /books/5/ DRF –¥–æ—Å—Ç–∞–Ω–µ—Ç –µ—ë
    # –∏–∑ –±–∞–∑—ã –∏ –ø–µ—Ä–µ–¥–∞—Å—Ç —Å—é–¥–∞ –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–µ instance.
    # üëâ —Ç–æ –µ—Å—Ç—å instance ‚Äî —ç—Ç–æ —Å—Ç–∞—Ä–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–±—ä–µ–∫—Ç–∞, –¥–æ –∏–∑–º–µ–Ω–µ–Ω–∏–π.
    # üëâ –∞ validated_data ‚Äî —ç—Ç–æ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞ (—É–∂–µ –ø—Ä–æ—à–µ–¥—à–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é).

    # \\\\\\  –ú–æ–∂–Ω–æ –ª–∏ –ø–æ–º–µ–Ω—è—Ç—å –∏–º–µ–Ω–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤?  ///////
    # –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏ –¥–∞ üòÖ
    #   - Python –Ω–µ —Ç—Ä–µ–±—É–µ—Ç –∏–º–µ–Ω–Ω–æ instance –∏–ª–∏ attrs.
    #   - –í–∞–∂–Ω–æ —Ç–æ–ª—å–∫–æ, —á—Ç–æ–±—ã –ø–æ–∑–∏—Ü–∏—è –∞—Ä–≥—É–º–µ–Ω—Ç–∞ —Å–æ–≤–ø–∞–¥–∞–ª–∞.
    # –ù–∞–ø—Ä–∏–º–µ—Ä, –º–æ–∂–Ω–æ –Ω–∞–ø–∏—Å–∞—Ç—å:
    # def update(self, obj, new_data):
    #     ...
    # –ò –≤—Å—ë –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å.
    #
    # –ù–æ üëá
    #   - instance –∏ validated_data ‚Äî —ç—Ç–æ –¥–µ-—Ñ–∞–∫—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∏–º–µ–Ω–∞, –∏—Ö –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è
    #     Django REST Framework.
    #   - –¢–æ –∂–µ —Å–∞–º–æ–µ —Å attrs –≤ validate.
    #   - –ï—Å–ª–∏ –ø–æ–º–µ–Ω—è—Ç—å, –∫–æ–¥ —Å—Ç–∞–Ω–µ—Ç –º–µ–Ω–µ–µ —á–∏—Ç–∞–µ–º—ã–º –¥–ª—è –¥—Ä—É–≥–∏—Ö —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (–∏ –¥–ª—è —Ç–µ–±—è —Å–∞–º–æ–π —á–µ—Ä–µ–∑ –ø–∞—Ä—É –º–µ—Å—è—Ü–µ–≤ üôÉ).
    # ‚úÖ –ü–æ—ç—Ç–æ–º—É –ª—É—á—à–µ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞—Ç—å—Å—è –∏–º–µ–Ω–Ω–æ —ç—Ç–∏—Ö –∏–º—ë–Ω.
    # –≠—Ç–æ –Ω–µ –º–∞–≥–∏—è –∏ –Ω–µ –∑–∞—Ä–µ–∑–µ—Ä–≤–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ–≤–∞, –Ω–æ —ç—Ç–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç, —á—Ç–æ–±—ã –≤—Å–µ–º –±—ã–ª–æ –ø–æ–Ω—è—Ç–Ω–æ –±–µ–∑ –ª–∏—à–Ω–∏—Ö –≤–æ–ø—Ä–æ—Å–æ–≤.
    # =================================================================

    # ==============================================================================
    # https://chatgpt.com/s/t_68bd20d5fb58819180ace0aceeec6ad6

    # \\\\\\   SLUG  ///////
    # Slug ‚Äî —ç—Ç–æ ‚Äú—á–µ–ª–æ–≤–µ–∫–æ—á–∏—Ç–∞–µ–º—ã–π‚Äù –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ–±—ä–µ–∫—Ç–∞, –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–π –≤ URL.
    # üîπ –í –ø–µ—Ä–µ–≤–æ–¥–µ —Å –∞–Ω–≥–ª–∏–π—Å–∫–æ–≥–æ slug ‚Äî ¬´–ø—É–ª—è, —Å–Ω–∞—Ä—è–¥¬ª, –Ω–æ –≤ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ —ç—Ç–æ —Å–ª–æ–≤–æ
    # —Å—Ç–∞–ª–æ –æ–∑–Ω–∞—á–∞—Ç—å –∫–æ—Ä–æ—Ç–∫–∏–π —Ç–µ–∫—Å—Ç–æ–≤—ã–π —è—Ä–ª—ã–∫, –∫–æ—Ç–æ—Ä—ã–π —É–¥–æ–±–Ω–æ –≤—Å—Ç–∞–≤–ª—è—Ç—å –≤ –∞–¥—Ä–µ—Å —Å—Å—ã–ª–∫–∏.
    #   –ü—Ä–∏–º–µ—Ä:
    #       –£ —Ç–µ–±—è –µ—Å—Ç—å —Å—Ç–∞—Ç—å—è —Å –∑–∞–≥–æ–ª–æ–≤–∫–æ–º:
    #       "10 —Å–æ–≤–µ—Ç–æ–≤, –∫–∞–∫ —É—á–∏—Ç—å Python"
    #       –î–ª—è URL —Ç–µ–±–µ –ª—É—á—à–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —á—Ç–æ-—Ç–æ –∫–æ—Ä–æ—Ç–∫–æ–µ –∏ —É–¥–æ–±–Ω–æ–µ:
    #       https://example.com/articles/10-sovetov-kak-uchit-python
    #   –í–æ—Ç —ç—Ç–∞ —á–∞—Å—Ç—å 10-sovetov-kak-uchit-

    # \\\\\\   –î–ª—è —á–µ–≥–æ –Ω—É–∂–µ–Ω  SLUG  ///////
    # 1. SEO ‚Äî –ø–æ–∏—Å–∫–æ–≤—ã–º —Å–∏—Å—Ç–µ–º–∞–º –ª–µ–≥—á–µ –∏–Ω–¥–µ–∫—Å–∏—Ä–æ–≤–∞—Ç—å –∏ –ø–æ–Ω–∏–º–∞—Ç—å –∞–¥—Ä–µ—Å–∞.
    #   /article/15
    #       –º–µ–Ω–µ–µ –ø–æ–Ω—è—Ç–µ–Ω, —á–µ–º
    #   /article/kak-uchit-python
    # –£–¥–æ–±—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Äî —á–∏—Ç–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –ø–æ–Ω–∏–º–∞–µ—Ç, –æ —á—ë–º —Å—Ç—Ä–∞–Ω–∏—Ü–∞.
    # –£–Ω–∏–∫–∞–ª—å–Ω–æ—Å—Ç—å ‚Äî –æ–±—ã—á–Ω–æ slug –¥–µ–ª–∞—é—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–º –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ç–∞–±–ª–∏—Ü—ã
    # (–Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –ø–æ—Å—Ç–æ–≤ –≤ –±–ª–æ–≥–µ).
    # 2. –í Django:
    # –í –º–æ–¥–µ–ª—è—Ö —á–∞—Å—Ç–æ –µ—Å—Ç—å –ø–æ–ª–µ SlugField, –Ω–∞–ø—Ä–∏–º–µ—Ä:
    #       from django.db import models
    #       from django.utils.text import slugify
    #
    #       class Article(models.Model):
    #           title = models.CharField(max_length=200)
    #           slug = models.SlugField(unique=True, blank=True)
    #
    #           def save(self, *args, **kwargs):
    #               if not self.slug:
    #                   # –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—ë–º slug –∏–∑ title:
    #                   self.slug = slugify(self.title)
    #               super().save(*args, **kwargs)
    # –ó–¥–µ—Å—å slugify("10 —Å–æ–≤–µ—Ç–æ–≤, –∫–∞–∫ —É—á–∏—Ç—å Python") –ø—Ä–µ–≤—Ä–∞—Ç–∏—Ç —Å—Ç—Ä–æ–∫—É –≤:
    #   10-sovetov-kak-uchit-python

    # –ö–∞–∫ slug –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –≤ Django-—Ä–æ—É—Ç–∞—Ö, –Ω–∞–ø—Ä–∏–º–µ—Ä, –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Å—Ç–∞—Ç—å—è–º
    # —á–µ—Ä–µ–∑ slug, –∞ –Ω–µ —á–µ—Ä–µ–∑ id: https://chatgpt.com/s/t_68bd21f7d23c81918de7108bf6f07367.
    # ==============================================================================



# –°–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª—å/JSON –∏ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ü–†–ï–î–°–¢–ê–í–õ–ï–ù–ò–Ø –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –ö–ù–ò–ì–ï:
#   - –º–æ–¥–µ–ª—å: –º–æ–¥–µ–ª—å ‚Üí JSON -–¥–ª—è –æ—Ç–¥–∞—á–∏ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É.
# –∏–ª–∏
#   - JSON: JSON ‚Üí –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
class BookSerializer(serializers.ModelSerializer):
    """

    """
    # üìå BookSerializer
    # –≠—Ç–æ ¬´–æ–±—â–∏–π¬ª —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä.
    # –û–Ω –≤—ã–≤–æ–¥–∏—Ç –≤—Å–µ –ø–æ–ª—è (fields='__all__), –∏ –≤ to_representation –º–æ–∂–µ—Ç —É–±–∏—Ä–∞—Ç—å –ø–æ–ª–µ genres, –µ—Å–ª–∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–Ω —Ñ–ª–∞–≥ –≤ context.
    # –¢–æ –µ—Å—Ç—å –æ–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π: –∏–Ω–æ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –º–µ–Ω—å—à–µ –¥–∞–Ω–Ω—ã—Ö, –∏–Ω–æ–≥–¥–∞ –±–æ–ª—å—à–µ.

    class Meta:
        model = Book
        fields = '__all__'               # —Å–µ—Ä–∏–∞–ª–∏–∑—É–µ–º –≤—Å–µ –ø–æ–ª—è –º–æ–¥–µ–ª–∏.
        read_only_fields = ['owner']     # –î–µ–ª–∞–µ–º –ø–æ–ª–µ 'owner' —Ç–æ–ª—å–∫–æ –¥–ª—è —á—Ç–µ–Ω–∏—è.

    # –ú–µ—Ç–æ–¥, –∫–æ—Ç–æ—Ä—ã–π –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç, –∫–∞–∫ –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂—ë–Ω –≤ JSON.
    # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ModelSerializer –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.
    # –ù–æ –µ—Å–ª–∏ –Ω–∞–º –Ω—É–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –≤—ã–≤–æ–¥ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∫—Ä—ã—Ç—å –∫–∞–∫–∏–µ-—Ç–æ –ø–æ–ª—è),
    # –º—ã –º–æ–∂–µ–º –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å to_representation.
    def to_representation(self, instance):
        # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ –≤–∏–¥–µ —Å–ª–æ–≤–∞—Ä—è:
        representation = super().to_representation(instance)

        # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–ª–∞–≥, –∫–æ—Ç–æ—Ä—ã–π –º—ã –ø–µ—Ä–µ–¥–∞–ª–∏ –∏–∑ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è. –ü–æ —Å—É—Ç–∏
        # –ø—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ –∫–ª—é—á 'include_related'.
        # –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç, —Ç–æ —É–±–∏—Ä–∞–µ–º –ø–æ–ª–µ 'genres' –∏–∑ JSON:
        if not self.context.get('include_related'):
            # –ï—Å–ª–∏ —Ñ–ª–∞–≥ false, —É–¥–∞–ª—è–µ–º –ø–æ–ª–µ (–∫–ª—é—á) 'genres' –∏–∑ –æ—Ç–≤–µ—Ç–∞:
            representation.pop('genres', None)
        # –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –∏—Ç–æ–≥–æ–≤–æ–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:
        return representation
        # –ò—Ç–æ–≥. –ó–¥–µ—Å—å –ª–æ–≥–∏–∫–∞ —Ç–∞–∫–∞—è:
        #   - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä –≤–µ—Ä–Ω—ë—Ç –≤—Å–µ –ø–æ–ª—è (__all__).
        #   - –ù–æ –µ—Å–ª–∏ –≤ context –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏
        #     include_related=True, —Ç–æ –ø–æ–ª–µ genres –±—É–¥–µ—Ç —É–±—Ä–∞–Ω–æ –∏–∑ –æ—Ç–≤–µ—Ç–∞.
        # üìå –≠—Ç–æ —É–¥–æ–±–Ω–æ, –µ—Å–ª–∏ —Ç—ã —Ö–æ—á–µ—à—å –∏–Ω–æ–≥–¥–∞ –æ—Ç–¥–∞–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ —Å –∂–∞–Ω—Ä–∞–º–∏, –∞ –∏–Ω–æ–≥–¥–∞ ‚Äî –±–µ–∑ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —á—Ç–æ–±—ã –Ω–µ –≥—Ä—É–∑–∏—Ç—å –ª–∏—à–Ω—é—é –∏–Ω—Ñ—É –ø—Ä–∏ —Å–ø–∏—Å–∫–µ –∫–Ω–∏–≥).

    # ==============================================================================
    # https://chatgpt.com/s/t_68bd2abbdad88191ab3e5c50c2fc9537

    # \\\\\\   context —É —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞  ///////
    # –ö–æ–≥–¥–∞ —Ç—ã —Å–æ–∑–¥–∞—ë—à—å —ç–∫–∑–µ–º–ø–ª—è—Ä —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –≤ DRF, –µ–º—É –º–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ –∞—Ä–≥—É–º–µ–Ω—Ç context.
    # –≠—Ç–æ –æ–±—ã—á–Ω—ã–π —Å–ª–æ–≤–∞—Ä—å dict, –≤ –∫–æ—Ç–æ—Ä–æ–º –º–æ–∂–Ω–æ —Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë, —á—Ç–æ —Ç–µ–±–µ –º–æ–∂–µ—Ç –ø—Ä–∏–≥–æ–¥–∏—Ç—å—Å—è –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞.
    # –ù–∞–ø—Ä–∏–º–µ—Ä:
    #   - —Å–∞–º request (—á–∞—Å—Ç–æ –Ω—É–∂–µ–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è),
    #   - –∫–∞–∫–∏–µ-—Ç–æ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã, –≤–ª–∏—è—é—â–∏–µ –Ω–∞ —Ç–æ, —á—Ç–æ –ø–æ–∫–∞–∑–∞—Ç—å/—Å–∫—Ä—ã—Ç—å,
    #   - –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–ª–∞–≥–∏ (include_related, expand, –∏ —Ç.–ø.).

    # \\\\\\   –ì–¥–µ context –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é  ///////
    # DRF –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–¥–∞—ë—Ç –≤ context –æ–±—ä–µ–∫—Ç request, –µ—Å–ª–∏ —Ç—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å
    # —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä —á–µ—Ä–µ–∑ generic views –∏–ª–∏ viewsets.
    # –ù–∞–ø—Ä–∏–º–µ—Ä:
    #   serializer = BookSerializer(book, context={'request': request})
    # –¢–µ–ø–µ—Ä—å –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –º–æ–∂–Ω–æ –ø–æ–ª—É—á–∏—Ç—å request:
    #   self.context['request']

    # \\\\\\   –ö–∞–∫ –ø–µ—Ä–µ–¥–∞—Ç—å —Å–≤–æ–π context?  ///////
    # –¢—ã —Å–∞–º–∞ —Ä–µ—à–∞–µ—à—å, —á—Ç–æ —Ç—É–¥–∞ –ø–æ–ª–æ–∂–∏—Ç—å. –ù–∞–ø—Ä–∏–º–µ—Ä, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å —É–ø—Ä–∞–≤–ª—è—Ç—å –≤—ã–≤–æ–¥–æ–º genres:
    #   # –ø—Ä–∏–º–µ—Ä –≤ views.py
    #   def book_detail(request, pk):
    #       book = get_object_or_404(Book, pk=pk)
    #
    #       serializer = BookSerializer(
    #             book,
    #           context={'include_related': True}  # –¥–æ–±–∞–≤–∏–ª–∏ –Ω–∞—à —Ñ–ª–∞–≥ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
    #       )
    #       return Response(serializer.data)
    # üìå –¢–µ–ø–µ—Ä—å –≤ –º–µ—Ç–æ–¥–µ to_representation —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ —É—Å–ª–æ–≤–∏–µ:
    #   if not self.context.get('include_related'):
    #         representation.pop('genres', None)
    # –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Ç–∞–∫:
    #   - –µ—Å–ª–∏ include_related=True, —Ç–æ genres –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –≤ JSON;
    #   - –µ—Å–ª–∏ include_related –Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏ –∏–ª–∏ –æ–Ω False ‚Üí –ø–æ–ª–µ genres —É–±–µ—Ä—ë—Ç—Å—è.
    # ‚ú® –¢–æ –µ—Å—Ç—å "–Ω–µ –ø–µ—Ä–µ–¥–∞–ª–∏" –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞ –≤ –∞—Ä–≥—É–º–µ–Ω—Ç
    # context={...} –Ω–µ –¥–æ–±–∞–≤–∏–ª–∏ –Ω–∞—à –∫–ª—é—á include_related. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä
    # —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ —Å–∫—Ä—ã–≤–∞–µ—Ç genres.
    # ==============================================================================




# –°–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª—å/JSON –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –ö–ù–ò–ì–ï:
#   - –º–æ–¥–µ–ª—å: –º–æ–¥–µ–ª—å ‚Üí JSON -–¥–ª—è –æ—Ç–¥–∞—á–∏ –æ—Ç–≤–µ—Ç–∞ –∫–ª–∏–µ–Ω—Ç—É.
# –∏–ª–∏
#   - JSON: JSON ‚Üí –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏ - –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è/–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.
class BookDetailSerializer(serializers.ModelSerializer):
    """

    """
    # üìå BookDetailSerializer
    # –ï–≥–æ –∫–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:
    # 1. –Ø–≤–Ω–æ —É–∫–∞–∑–∞–Ω—ã –ø–æ–ª—è publisher –∏ genres:
    #       - –û–±–∞ –æ–Ω–∏ ‚Äî —Å–≤—è–∑–∏ —Å –¥—Ä—É–≥–∏–º–∏ –º–æ–¥–µ–ª—è–º–∏ (ForeignKey –∏ ManyToManyField).
    #       - –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é DRF —Å–µ—Ä–∏–∞–ª–∏–∑–æ–≤–∞–ª –±—ã –∏—Ö —á–µ—Ä–µ–∑ id –∏–ª–∏ —á–µ—Ä–µ–∑ __str__ (–≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫).
    #       - –ê —Ç—É—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è PrimaryKeyRelatedField, –∫–æ—Ç–æ—Ä—ã–π —è–≤–Ω–æ –≥–æ–≤–æ—Ä–∏—Ç:
    #         üëâ –≤—ã–≤–æ–¥–∏—Ç—å –Ω–µ –≤–ª–æ–∂–µ–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç, –∞ —Ç–æ–ª—å–∫–æ –µ–≥–æ –ø–µ—Ä–≤–∏—á–Ω—ã–π –∫–ª—é—á (id).
    #   –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
    #       {
    #           "id": 1,
    #           "title": "–ö–∞–∫ —É—á–∏—Ç—å Python",
    #           "publisher": 3,     # —Ç–æ–ª—å–∫–æ ID –∏–∑–¥–∞—Ç–µ–ª—è!
    #           "genres": [2, 5]    # —Å–ø–∏—Å–æ–∫ ID –∂–∞–Ω—Ä–æ–≤!
    #       }

    # publisher = PublisherSerializer()
    # publisher = serializers.StringRelatedField()

    # publisher = serializers.SlugRelatedField(
    #     slug_field='slug',
    #     queryset=Publisher.objects.all(),
    # )

    publisher = serializers.PrimaryKeyRelatedField(queryset=Publisher.objects.all())
    genres = serializers.PrimaryKeyRelatedField(queryset=Genre.objects.all(), many=True)

    class Meta:
        model = Book
        fields = '__all__'

    # 2. –û—Ç–ª–∏—á–∏–µ –æ—Ç BookSerializer:
    #   - BookSerializer –º–æ–∂–µ—Ç –±—ã—Ç—å –±–æ–ª–µ–µ ¬´–≥–∏–±–∫–∏–º¬ª –∏ —Ä–∞–±–æ—Ç–∞—Ç—å —Å –∫–∞—Å—Ç–æ–º–Ω–æ–π –ª–æ–≥–∏–∫–æ–π
    #     (to_representation, —Å–∫—Ä—ã—Ç–∏–µ –ø–æ–ª–µ–π).
    #   - BookDetailSerializer –Ω—É–∂–µ–Ω –∏–º–µ–Ω–Ω–æ –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è, –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ
    #     –æ—Ç—Ä–∞–∑–∏—Ç—å —Å–≤—è–∑–∏ —á–µ—Ä–µ–∑ ID, —á—Ç–æ–±—ã –ø–æ—Ç–æ–º —É–¥–æ–±–Ω–æ –æ–±–Ω–æ–≤–ª—è—Ç—å/—Å–æ–∑–¥–∞–≤–∞—Ç—å –∑–∞–ø–∏—Å–∏.
    # üìå –¢–æ –µ—Å—Ç—å, –µ—Å–ª–∏ BookSerializer –±–æ–ª—å—à–µ –ø—Ä–æ "–≤—ã–≤–æ–¥ –∫—Ä–∞—Å–∏–≤–æ –∏ –≤—ã–±–æ—Ä–æ—á–Ω–æ",
    # —Ç–æ BookDetailSerializer ‚Äî "—É–¥–æ–±—Å—Ç–≤–æ CRUD-–æ–ø–µ—Ä–∞—Ü–∏–π" (—Å–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ/–¥–µ—Ç–∞–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä).

    # ==============================================================================
    # https://chatgpt.com/s/t_68bd2bee9f9c8191ae45b97de641edd1

    # \\\\\\   –ß—Ç–æ –¥–µ–ª–∞–µ—Ç PrimaryKeyRelatedField?  ///////
    # –≠—Ç–æ —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–µ –ø–æ–ª–µ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä–∞, –∫–æ—Ç–æ—Ä–æ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–æ —Å–≤—è–∑–∞–Ω–Ω—ã–º–∏ –º–æ–¥–µ–ª—è–º–∏.
    #   - PrimaryKeyRelatedField(queryset=Publisher.objects.all()) –æ–∑–Ω–∞—á–∞–µ—Ç:
    #       + –ø—Ä–∏ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ ‚Üí –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å —Ç–æ–ª—å–∫–æ ID –∏–∑–¥–∞—Ç–µ–ª—è;
    #       + –ø—Ä–∏ –î–ï—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –∫–Ω–∏–≥–∏ —á–µ—Ä–µ–∑ POST) ‚Üí –ø—Ä–∏–Ω–∏–º–∞—Ç—å ID –∏ –∏—Å–∫–∞—Ç—å –ø–æ –Ω–µ–º—É –æ–±—ä–µ–∫—Ç –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ queryset.
    #   - many=True —É –∂–∞–Ω—Ä–æ–≤ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ —ç—Ç–æ —Å–ø–∏—Å–æ–∫ ID (—Ç–∞–∫ –∫–∞–∫ —Å–≤—è–∑—å ManyToMany).
    # –ü—Ä–∏–º–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –∫–Ω–∏–≥–∏ —á–µ—Ä–µ–∑ API:
    #       {
    #           "title": "–ù–æ–≤–∞—è –∫–Ω–∏–≥–∞",
    #           "publisher": 3,
    #           "genres": [1, 4]
    #       }
    # –ó–¥–µ—Å—å 3 ‚Äî id –∏–∑–¥–∞—Ç–µ–ª—è, [1, 4] ‚Äî id –∂–∞–Ω—Ä–æ–≤. –°–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä —Å–∞–º –Ω–∞–π–¥—ë—Ç –Ω—É–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã –∏ —Å–≤—è–∂–µ—Ç –∏—Ö.
    # ‚ú® –¢–∞–∫–∏–º –æ–±—Ä–∞–∑–æ–º:
    #   - BookSerializer ‚Äî –≥–∏–±–∫–∏–π, –º–æ–∂–Ω–æ –ø—Ä—è—Ç–∞—Ç—å –∏–ª–∏ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å genres –ø–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç—É.
    #   - BookDetailSerializer ‚Äî –¥–ª—è CRUD, —Å–≤—è–∑–∏ (publisher, genres) —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ä–µ–∑
    #     PrimaryKeyRelatedField, —Ç.–µ. –ø—Ä–∏–Ω–∏–º–∞—é—Ç –∏ –æ—Ç–¥–∞—é—Ç ID –≤–º–µ—Å—Ç–æ –≤–ª–æ–∂–µ–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
    # ==============================================================================



# –°–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª—å/JSON –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ –ñ–ê–ù–†–ê–ú.
class GenreSerializer(serializers.ModelSerializer):
    """

    """
    class Meta:
        model = Genre
        fields = '__all__'



# –°–µ—Ä–∏–∞–ª–∞–π–∑–µ—Ä –¥–ª—è –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –º–æ–¥–µ–ª—å/JSON –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ ????????????????.
class SimpleBookSerializer(serializers.ModelSerializer):
    """

    """
    class Meta:
        model = SimpleBook
        fields = '__all__'
